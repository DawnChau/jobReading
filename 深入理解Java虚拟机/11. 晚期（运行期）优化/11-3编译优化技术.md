## 11-3编译优化技术

### 11-3-1 优化技术概览

- 方法内联的重要性高于其他优化措施
  - 去除方法调用的成本（如建立栈帧）
  - 为其他优化建立良好基础
- 语言无关的经典优化技术：公共子表达式的消除
- 语言有关的经典优化技术：数组范围检查消除
- 最重要的优化技术之一：方法内联
- 最前沿的优化技术之一：逃逸分析

### 11-3-3 数组边界检查消除

- 数组循环访问时候可以消除
- 隐式异常优化：
  - 虚拟机会注册一个Segment Fault信号的异常处理器，对value的访问不会额外消耗一次对foo判空的开销
  - 代价是异常时候必须从用户态切回到内核态，处理结束之后再切回到用户态

### 11-3-4 方法内联

- java语言的默认实例方法是虚方法
- 虚方法的内联问题
  - 如果只有一个版本，可以进行内联，不过是激进优化，需要预留一个逃生门，称为”守护内联”
  - 若是CHA查询出来有多个版本，编译器还会使用内联缓存来完成方法内联

### 11-3-5 逃逸分析

- 栈上分配（如果确定该对象不会逃逸）
- 消除同步
- 标量替换（对象拆散）