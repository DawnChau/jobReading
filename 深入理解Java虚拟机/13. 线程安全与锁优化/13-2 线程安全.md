## 13-2 线程安全

### 13-2-1 Java语言中的线程安全

- 不可变对象
- 绝对线程安全
  - vector的remove，get虽然是同步方法，但是在调用端还必须增加同步控制
- 线程相对安全

### 13-2-2 线程安全的实现方法

- 互斥同步
  - 共享数据的互斥访问：临界区，互斥量，信号量
  - 互斥是因，同步是果
  - monitorenter和monitorexit的reference类型的参数需要指定明确的对象（对象锁）
  - synchronized是可重入的
  - ReentrantLock的优点
    - 等待可中断
      - 当持有锁的线程长期不释放锁，正在等待的线程可以选择放弃等待
    - 可实现公平锁
    - 锁可以绑定多个条件
      - 可以绑定多个Condition对象
- 非阻塞同步
  - 互斥同步最主要的问题就是进行线程阻塞和唤醒所带来的性能问题
  - CAS
    - 变量的内存地址
    - 旧值
    - 新值
    - 变量中的值 = 旧值时候，才会更新为新值
    - Unsafe底层实现
    - 会造成ABA问题，解决办法是控制变量值的版本
- 无同步方案